---
title: 'Effect ржерзЗржХрзЗ Event ржЖрж▓рж╛ржжрж╛ ржХрж░рж╛'
---

<Intro>

Event handler рж╢рзБржзрзБржорж╛рждрзНрж░ рждржЦржиржЗ ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝ ржпржЦржи ржЖржкржирж┐ ржПржХржЗ interaction ржЖржмрж╛рж░ рж╕ржорзНржкрж╛ржжржи ржХрж░рзЗржиред Event handler ржПрж░ ржмрж┐ржкрж░рзАрждрзЗ, Effect ржкрзБржирж░рж╛ржпрж╝ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ рж╣ржпрж╝ ржпржжрж┐ рждрж╛рж░рж╛ ржпрзЗ ржХрзЛржирзЛ ржорж╛ржи ржкржбрж╝рзЗ, ржпрзЗржоржи ржПржХржЯрж┐ prop ржмрж╛ ржПржХржЯрж┐ state variable, рж╢рзЗрж╖ render ржПрж░ рж╕ржоржпрж╝ ржпрж╛ ржЫрж┐рж▓ рждрж╛рж░ ржерзЗржХрзЗ ржнрж┐ржирзНржи рж╣ржпрж╝ред ржХржЦржиржУ ржХржЦржиржУ, ржЖржкржирж┐ ржЙржнржпрж╝ ржЖржЪрж░ржгрзЗрж░ ржорж┐рж╢рзНрж░ржгржУ ржЪрж╛ржи: ржПржХржЯрж┐ Effect ржпрж╛ ржХрж┐ржЫрзБ ржорж╛ржирзЗрж░ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржпрж╝ ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝ ржХрж┐ржирзНрждрзБ ржЕржирзНржпржжрзЗрж░ ржЬржирзНржп ржиржпрж╝ред ржПржЗ ржкрзГрж╖рзНржарж╛ржЯрж┐ ржЖржкржирж╛ржХрзЗ рж╢рзЗржЦрж╛ржмрзЗ ржХрж┐ржнрж╛ржмрзЗ ржПржЯрж┐ ржХрж░рждрзЗ рж╣ржпрж╝ред

</Intro>

<YouWillLearn>

- ржХрж┐ржнрж╛ржмрзЗ ржПржХржЯрж┐ event handler ржПржмржВ ржПржХржЯрж┐ Effect ржПрж░ ржоржзрзНржпрзЗ ржмрзЗржЫрзЗ ржирж┐рждрзЗ рж╣ржпрж╝
- ржХрзЗржи Effect reactive, ржПржмржВ event handler reactive ржиржпрж╝
- ржЖржкржирж╛рж░ Effect ржПрж░ ржХрзЛржбрзЗрж░ ржПржХржЯрж┐ ржЕржВрж╢ reactive ржирж╛ рж╣рждрзЗ ржЪрж╛ржЗрж▓рзЗ ржХрж┐ ржХрж░рждрзЗ рж╣ржмрзЗ
- Effect Event ржХрж┐, ржПржмржВ ржХрж┐ржнрж╛ржмрзЗ ржЖржкржирж╛рж░ Effect ржерзЗржХрзЗ рж╕рзЗржЧрзБрж▓рж┐ extract ржХрж░рждрзЗ рж╣ржпрж╝
- ржХрж┐ржнрж╛ржмрзЗ Effect Event ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Effect ржерзЗржХрзЗ рж╕рж░рзНржмрж╢рзЗрж╖ props ржПржмржВ state ржкржбрж╝рждрзЗ рж╣ржпрж╝

</YouWillLearn>

## Event handler ржПржмржВ Effect ржПрж░ ржоржзрзНржпрзЗ ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛ {/*choosing-between-event-handlers-and-effects*/}

ржкрзНрж░ржержорзЗ, ржЖрж╕рзБржи event handler ржПржмржВ Effect ржПрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп ржкрзБржирж░рж╛ржпрж╝ ржжрзЗржЦрж┐ред

ржХрж▓рзНржкржирж╛ ржХрж░рзБржи ржЖржкржирж┐ ржПржХржЯрж┐ chat room ржХржорзНржкрзЛржирзЗржирзНржЯ implement ржХрж░ржЫрзЗржиред ржЖржкржирж╛рж░ requirements ржПрж░ржХржо ржжрзЗржЦрж╛ржЪрзНржЫрзЗ:

1. ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд chat room ржП рж╕ржВржпрзБржХрзНржд рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред
1. ржпржЦржи ржЖржкржирж┐ "Send" button ржП ржХрзНрж▓рж┐ржХ ржХрж░рзЗржи, рждржЦржи ржПржЯрж┐ chat ржП ржПржХржЯрж┐ message ржкрж╛ржарж╛ржирзЛ ржЙржЪрж┐рждред

ржзрж░рж╛ ржпрж╛ржХ ржЖржкржирж┐ ржЗрждрж┐ржоржзрзНржпрзЗ рждрж╛ржжрзЗрж░ ржЬржирзНржп ржХрзЛржб implement ржХрж░рзЗржЫрзЗржи, ржХрж┐ржирзНрждрзБ ржЖржкржирж┐ ржирж┐рж╢рзНржЪрж┐ржд ржиржи ржХрзЛржерж╛ржпрж╝ ржПржЯрж┐ рж░рж╛ржЦржмрзЗржиред ржЖржкржирж╛рж░ ржХрж┐ event handler ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЙржЪрж┐ржд ржирж╛ржХрж┐ Effect? ржкрзНрж░рждрж┐ржмрж╛рж░ ржпржЦржи ржЖржкржирж╛ржХрзЗ ржПржЗ ржкрзНрж░рж╢рзНржирзЗрж░ ржЙрждрзНрждрж░ ржжрж┐рждрзЗ рж╣ржмрзЗ, ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рзБржи [*ржХрзЗржи* ржХрзЛржбржЯрж┐ ржЪрж╛рж▓рж╛ржирзЛ ржкрзНрж░ржпрж╝рзЛржЬржиред](/learn/synchronizing-with-effects#what-are-effects-and-how-are-they-different-from-events)

### Event handler ржирж┐рж░рзНржжрж┐рж╖рзНржЯ interaction ржПрж░ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝ {/*event-handlers-run-in-response-to-specific-interactions*/}

ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ, ржПржХржЯрж┐ message ржкрж╛ржарж╛ржирзЛ ржЙржЪрж┐ржд *ржХрж╛рж░ржг* ржирж┐рж░рзНржжрж┐рж╖рзНржЯ "Send" button ржХрзНрж▓рж┐ржХ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрж┐рж▓ред ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзЗрж╢ ржмрж┐рж░ржХрзНржд рж╣ржмрзЗржи ржпржжрж┐ ржЖржкржирж┐ рждрж╛ржжрзЗрж░ message ржЕржирзНржп ржХрзЛржирзЛ рж╕ржоржпрж╝рзЗ ржмрж╛ ржЕржирзНржп ржХрзЛржирзЛ ржХрж╛рж░ржгрзЗ ржкрж╛ржарж╛ржиред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржПржХржЯрж┐ message ржкрж╛ржарж╛ржирзЛ ржПржХржЯрж┐ event handler рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред Event handler ржЖржкржирж╛ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ interaction handle ржХрж░рждрзЗ ржжрзЗржпрж╝:


```js {4-6}
function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');
  // ...
  function handleSendClick() {
    sendMessage(message);
  }
  // ...
  return (
    <>
      <input value={message} onChange={e => setMessage(e.target.value)} />
      <button onClick={handleSendClick}>Send</button>
    </>
  );
}
```

ржПржХржЯрж┐ event handler ржПрж░ рж╕рж╛ржерзЗ, ржЖржкржирж┐ ржирж┐рж╢рзНржЪрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ `sendMessage(message)` *рж╢рзБржзрзБржорж╛рждрзНрж░* рждржЦржиржЗ ржЪрж╛рж▓рзБ рж╣ржмрзЗ ржпржжрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА button ржЯрж┐ ржЪрж╛ржкрзЗржиред

### Effect ржпржЦржиржЗ synchronization ржкрзНрж░ржпрж╝рзЛржЬржи рждржЦржи ржЪрж╛рж▓рзБ рж╣ржпрж╝ {/*effects-run-whenever-synchronization-is-needed*/}

ржоржирзЗ ржХрж░рзБржи ржЖржкржирж╛ржХрзЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ржХрзЗ chat room ржПрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд рж░рж╛ржЦрждрзЗ рж╣ржмрзЗред рж╕рзЗржЗ ржХрзЛржбржЯрж┐ ржХрзЛржерж╛ржпрж╝ ржпрж╛ржпрж╝?

ржПржЗ ржХрзЛржбржЯрж┐ ржЪрж╛рж▓рж╛ржирзЛрж░ *ржХрж╛рж░ржг* ржХрзЛржирзЛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ interaction ржиржпрж╝ред ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржХрзЗржи ржмрж╛ ржХрж┐ржнрж╛ржмрзЗ chat room screen ржП navigate ржХрж░рзЗржЫрзЗ рждрж╛ ржХрзЛржирзЛ ржмрзНржпрж╛ржкрж╛рж░ ржирж╛ред ржПржЦржи ржпрзЗрж╣рзЗрждрзБ рждрж╛рж░рж╛ ржПржЯрж┐ ржжрзЗржЦржЫрзЗ ржПржмржВ ржПржЯрж┐рж░ рж╕рж╛ржерзЗ interact ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ржХрзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд chat server ржПрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд ржерж╛ржХрждрзЗ рж╣ржмрзЗред ржПржоржиржХрж┐ ржпржжрж┐ chat room ржХржорзНржкрзЛржирзЗржирзНржЯ ржЖржкржирж╛рж░ app ржПрж░ ржкрзНрж░рж╛ржержорж┐ржХ screen рж╣ржпрж╝, ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржХрзЛржирзЛ interaction рж╕ржорзНржкрж╛ржжржи ржирж╛ ржХрж░рзЗ ржерж╛ржХрзЗ, рждржмрзБржУ ржЖржкржирж╛ржХрзЗ *ржПржЦржиржУ* рж╕ржВржпрзБржХрзНржд рж╣рждрзЗ рж╣ржмрзЗред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржПржЯрж┐ ржПржХржЯрж┐ Effect:

```js {3-9}
function ChatRoom({ roomId }) {
  // ...
  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.connect();
    return () => {
      connection.disconnect();
    };
  }, [roomId]);
  // ...
}
```

ржПржЗ ржХрзЛржбрзЗрж░ рж╕рж╛ржерзЗ, ржЖржкржирж┐ ржирж┐рж╢рзНржЪрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржмрж░рзНрждржорж╛ржирзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд chat server ржПрж░ рж╕рж╛ржерзЗ рж╕рж░рзНржмржжрж╛ ржПржХржЯрж┐ рж╕ржХрзНрж░рж┐ржпрж╝ connection ржЖржЫрзЗ, *ржирж┐рж░рзНржмрж┐рж╢рзЗрж╖рзЗ* ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржжрзНржмрж╛рж░рж╛ рж╕ржорзНржкрж╛ржжрж┐ржд ржирж┐рж░рзНржжрж┐рж╖рзНржЯ interaction ржПрж░ред ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╢рзБржзрзБржорж╛рждрзНрж░ ржЖржкржирж╛рж░ app ржЦрзБрж▓рзЗржЫрзЗ, ржПржХржЯрж┐ ржнрж┐ржирзНржи room ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзЗржЫрзЗ, ржмрж╛ ржЕржирзНржп screen ржП navigate ржХрж░рзЗржЫрзЗ ржПржмржВ ржлрж┐рж░рзЗ ржПрж╕рзЗржЫрзЗ, ржЖржкржирж╛рж░ Effect ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ ржпрзЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ ржмрж░рзНрждржорж╛ржирзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд room ржПрж░ рж╕рж╛ржерзЗ *рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬржб ржерж╛ржХржмрзЗ*, ржПржмржВ [ржпржЦржиржЗ ржПржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЬржи рждржЦржи ржкрзБржирж░рж╛ржпрж╝ рж╕ржВржпрзБржХрзНржд рж╣ржмрзЗред](/learn/lifecycle-of-reactive-effects#why-synchronization-may-need-to-happen-more-than-once)


<Sandpack>

```js
import { useState, useEffect } from 'react';
import { createConnection, sendMessage } from './chat.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]);

  function handleSendClick() {
    sendMessage(message);
  }

  return (
    <>
      <h1>Welcome to the {roomId} room!</h1>
      <input value={message} onChange={e => setMessage(e.target.value)} />
      <button onClick={handleSendClick}>Send</button>
    </>
  );
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [show, setShow] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <button onClick={() => setShow(!show)}>
        {show ? 'Close chat' : 'Open chat'}
      </button>
      {show && <hr />}
      {show && <ChatRoom roomId={roomId} />}
    </>
  );
}
```

```js src/chat.js
export function sendMessage(message) {
  console.log('ЁЯФ╡ You sent: ' + message);
}

export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  return {
    connect() {
      console.log('тЬЕ Connecting to "' + roomId + '" room at ' + serverUrl + '...');
    },
    disconnect() {
      console.log('тЭМ Disconnected from "' + roomId + '" room at ' + serverUrl);
    }
  };
}
```

```css
input, select { margin-right: 20px; }
```

</Sandpack>

## Reactive value ржПржмржВ reactive logic {/*reactive-values-and-reactive-logic*/}

рж╕рзНржмржЬрзНржЮрж╛рждржнрж╛ржмрзЗ, ржЖржкржирж┐ ржмрж▓рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ event handler рж╕рж░рзНржмржжрж╛ "manually" trigger рж╣ржпрж╝, ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк ржПржХржЯрж┐ button ржХрзНрж▓рж┐ржХ ржХрж░рзЗред ржЕржирзНржпржжрж┐ржХрзЗ Effect, "automatic": рждрж╛рж░рж╛ ржЪрж╛рж▓рзБ рж╣ржпрж╝ ржПржмржВ ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝ ржпрждржмрж╛рж░ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬржб ржерж╛ржХрж╛рж░ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржпрж╝ред

ржПржЯрж┐ рж╕ржорзНржкрж░рзНржХрзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рж╛рж░ ржЖрж░ржУ рж╕рзБржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЙржкрж╛ржпрж╝ ржЖржЫрзЗред

ржЖржкржирж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ body ржПрж░ ржнрж┐рждрж░рзЗ ржШрзЛрж╖рж┐ржд Props, state, ржПржмржВ variable ржЧрзБрж▓рж┐ржХрзЗ <CodeStep step={2}>reactive value</CodeStep> ржмрж▓рж╛ рж╣ржпрж╝ред ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, `serverUrl` ржПржХржЯрж┐ reactive value ржиржпрж╝, ржХрж┐ржирзНрждрзБ `roomId` ржПржмржВ `message` рж╣рж▓ред рждрж╛рж░рж╛ rendering data flow ржП ржЕржВрж╢ржЧрзНрж░рж╣ржг ржХрж░рзЗ:

```js [[2, 3, "roomId"], [2, 4, "message"]]
const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  // ...
}
```

ржПржЗ ржзрж░ржирзЗрж░ reactive value ржПржХржЯрж┐ re-render ржПрж░ ржХрж╛рж░ржгрзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА `message` edit ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржмрж╛ ржПржХржЯрж┐ dropdown ржП ржПржХржЯрж┐ ржнрж┐ржирзНржи `roomId` ржмрзЗржЫрзЗ ржирж┐рждрзЗ ржкрж╛рж░рзЗред Event handler ржПржмржВ Effect ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржкрзНрж░рждрж┐ ржнрж┐ржирзНржиржнрж╛ржмрзЗ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ ржЬрж╛ржирж╛ржпрж╝:

- **Event handler ржПрж░ ржнрж┐рждрж░рзЗрж░ logic *reactive ржиржпрж╝ред*** ржПржЯрж┐ ржЖржмрж╛рж░ ржЪрж╛рж▓рзБ рж╣ржмрзЗ ржирж╛ ржпржжрж┐ ржирж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржХржЗ interaction (ржпрзЗржоржи ржПржХржЯрж┐ click) ржЖржмрж╛рж░ рж╕ржорзНржкрж╛ржжржи ржХрж░рзЗред Event handler reactive value ржкржбрж╝рждрзЗ ржкрж╛рж░рзЗ рждрж╛ржжрзЗрж░ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржкрзНрж░рждрж┐ "react" ржирж╛ ржХрж░рзЗред
- **Effect ржПрж░ ржнрж┐рждрж░рзЗрж░ logic *reactiveред*** ржпржжрж┐ ржЖржкржирж╛рж░ Effect ржПржХржЯрж┐ reactive value ржкржбрж╝рзЗ, [ржЖржкржирж╛ржХрзЗ ржПржЯрж┐ ржПржХржЯрж┐ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗред](/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values) рждрж╛рж░ржкрж░, ржпржжрж┐ ржПржХржЯрж┐ re-render рж╕рзЗржЗ ржорж╛ржиржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ, React ржирждрзБржи ржорж╛ржи ржжрж┐ржпрж╝рзЗ ржЖржкржирж╛рж░ Effect ржПрж░ logic ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ ржХрж░ржмрзЗред

ржЖрж╕рзБржи ржПржЗ ржкрж╛рж░рзНржержХрзНржпржЯрж┐ ржЪрж┐рждрзНрж░рж┐ржд ржХрж░рждрзЗ ржЖржЧрзЗрж░ ржЙржжрж╛рж╣рж░ржгржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ ржжрзЗржЦрж┐ред


### Event handler ржПрж░ ржнрж┐рждрж░рзЗрж░ logic reactive ржиржпрж╝ {/*logic-inside-event-handlers-is-not-reactive*/}

ржХрзЛржбрзЗрж░ ржПржЗ рж▓рж╛ржЗржиржЯрж┐ ржжрзЗржЦрзБржиред ржПржЗ logic ржХрж┐ reactive рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржирж╛ржХрж┐ ржиржпрж╝?

```js [[2, 2, "message"]]
    // ...
    sendMessage(message);
    // ...
```

ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ, **`message` ржП ржПржХржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи _ржорж╛ржирзЗ ржПржЗ ржиржпрж╝_ ржпрзЗ рждрж╛рж░рж╛ ржПржХржЯрж┐ message ржкрж╛ржарж╛рждрзЗ ржЪрж╛ржпрж╝ред** ржПрж░ ржорж╛ржирзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржЗ ржпрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЯрж╛ржЗржк ржХрж░ржЫрзЗред ржЕржирзНржп ржХржерж╛ржпрж╝, ржпрзЗ logic ржПржХржЯрж┐ message ржкрж╛ржарж╛ржпрж╝ рждрж╛ reactive рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржиржпрж╝ред ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ <CodeStep step={2}>reactive value</CodeStep> ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржУржпрж╝рж╛рж░ ржХрж╛рж░ржгрзЗ ржЖржмрж╛рж░ ржЪрж╛рж▓рзБ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржиржпрж╝ред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржПржЯрж┐ event handler ржП ржерж╛ржХрзЗ:

```js {2}
  function handleSendClick() {
    sendMessage(message);
  }
```

Event handler reactive ржиржпрж╝, рждрж╛ржЗ `sendMessage(message)` рж╢рзБржзрзБржорж╛рждрзНрж░ рждржЦржиржЗ ржЪрж╛рж▓рзБ рж╣ржмрзЗ ржпржЦржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА Send button ржЪрж╛ржкржмрзЗред

### Effect ржПрж░ ржнрж┐рждрж░рзЗрж░ logic reactive {/*logic-inside-effects-is-reactive*/}

ржПржЦржи ржЖрж╕рзБржи ржПржЗ рж▓рж╛ржЗржиржЧрзБрж▓рж┐рждрзЗ ржлрж┐рж░рзЗ ржпрж╛ржЗ:

```js [[2, 2, "roomId"]]
    // ...
    const connection = createConnection(serverUrl, roomId);
    connection.connect();
    // ...
```

ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ, **`roomId` ржП ржПржХржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи *ржорж╛ржирзЗ* ржпрзЗ рждрж╛рж░рж╛ ржПржХржЯрж┐ ржнрж┐ржирзНржи room ржП рж╕ржВржпрзБржХрзНржд рж╣рждрзЗ ржЪрж╛ржпрж╝ред** ржЕржирзНржп ржХржерж╛ржпрж╝, room ржП рж╕ржВржпрзБржХрзНржд рж╣ржУржпрж╝рж╛рж░ logic reactive рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред ржЖржкржирж┐ *ржЪрж╛ржи* ржпрзЗ ржХрзЛржбрзЗрж░ ржПржЗ рж▓рж╛ржЗржиржЧрзБрж▓рж┐ <CodeStep step={2}>reactive value</CodeStep> ржПрж░ рж╕рж╛ржерзЗ "keep up" ржХрж░рзБржХ, ржПржмржВ рж╕рзЗржЗ ржорж╛ржи ржнрж┐ржирзНржи рж╣рж▓рзЗ ржЖржмрж╛рж░ ржЪрж╛рж▓рзБ рж╣рзЛржХред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржПржЯрж┐ ржПржХржЯрж┐ Effect ржП ржерж╛ржХрзЗ:

```js {2-3}
  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.connect();
    return () => {
      connection.disconnect()
    };
  }, [roomId]);
```

Effect reactive, рждрж╛ржЗ `createConnection(serverUrl, roomId)` ржПржмржВ `connection.connect()` `roomId` ржПрж░ ржкрзНрж░рждрж┐ржЯрж┐ рж╕рзНржмрждржирзНрждрзНрж░ ржорж╛ржирзЗрж░ ржЬржирзНржп ржЪрж╛рж▓рзБ рж╣ржмрзЗред ржЖржкржирж╛рж░ Effect chat connection ржЯрж┐ржХрзЗ ржмрж░рзНрждржорж╛ржирзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд room ржПрж░ рж╕рж╛ржерзЗ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬржб рж░рж╛ржЦрзЗред

## Effect ржерзЗржХрзЗ non-reactive logic ржмрзЗрж░ ржХрж░рж╛ {/*extracting-non-reactive-logic-out-of-effects*/}

ржпржЦржи ржЖржкржирж┐ reactive logic ржПрж░ рж╕рж╛ржерзЗ non-reactive logic ржорж┐рж╢рзНрж░рж┐ржд ржХрж░рждрзЗ ржЪрж╛ржи рждржЦржи ржЬрж┐ржирж┐рж╕ржЧрзБрж▓рж┐ ржЖрж░ржУ ржЬржЯрж┐рж▓ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ред

ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржХрж▓рзНржкржирж╛ ржХрж░рзБржи ржпрзЗ ржЖржкржирж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА chat ржП рж╕ржВржпрзБржХрзНржд рж╣рж▓рзЗ ржПржХржЯрж┐ notification ржжрзЗржЦрж╛рждрзЗ ржЪрж╛ржиред ржЖржкржирж┐ props ржерзЗржХрзЗ ржмрж░рзНрждржорж╛ржи theme (dark ржмрж╛ light) ржкржбрж╝рзЗржи ржпрж╛рждрзЗ ржЖржкржирж┐ рж╕ржарж┐ржХ рж░ржЩрзЗ notification ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рзЗржи:

```js {1,4-6}
function ChatRoom({ roomId, theme }) {
  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      showNotification('Connected!', theme);
    });
    connection.connect();
    // ...
```

рждржмрзЗ, `theme` ржПржХржЯрж┐ reactive value (ржПржЯрж┐ re-rendering ржПрж░ ржлрж▓рзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗ), ржПржмржВ [ржПржХржЯрж┐ Effect ржжрзНржмрж╛рж░рж╛ ржкржбрж╝рж╛ ржкрзНрж░рждрж┐ржЯрж┐ reactive value ржЕржмрж╢рзНржпржЗ рждрж╛рж░ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗред](/learn/lifecycle-of-reactive-effects#react-verifies-that-you-specified-every-reactive-value-as-a-dependency) ржПржЦржи ржЖржкржирж╛ржХрзЗ ржЖржкржирж╛рж░ Effect ржПрж░ dependency рж╣рж┐рж╕рж╛ржмрзЗ `theme` ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ:

```js {5,11}
function ChatRoom({ roomId, theme }) {
  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      showNotification('Connected!', theme);
    });
    connection.connect();
    return () => {
      connection.disconnect()
    };
  }, [roomId, theme]); // тЬЕ рж╕ржорж╕рзНржд dependency ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
  // ...
```

ржПржЗ ржЙржжрж╛рж╣рж░ржгржЯрж┐ ржирж┐ржпрж╝рзЗ ржЦрзЗрж▓рзБржи ржПржмржВ ржжрзЗржЦрзБржи ржЖржкржирж┐ ржХрж┐ ржПржЗ user experience ржПрж░ рж╕ржорж╕рзНржпрж╛ржЯрж┐ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржи:


<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "latest",
    "react-dom": "latest",
    "react-scripts": "latest",
    "toastify-js": "1.12.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { createConnection, sendMessage } from './chat.js';
import { showNotification } from './notifications.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId, theme }) {
  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      showNotification('Connected!', theme);
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId, theme]);

  return <h1>Welcome to the {roomId} room!</h1>
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [isDark, setIsDark] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <label>
        <input
          type="checkbox"
          checked={isDark}
          onChange={e => setIsDark(e.target.checked)}
        />
        Use dark theme
      </label>
      <hr />
      <ChatRoom
        roomId={roomId}
        theme={isDark ? 'dark' : 'light'}
      />
    </>
  );
}
```

```js src/chat.js
export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  let connectedCallback;
  let timeout;
  return {
    connect() {
      timeout = setTimeout(() => {
        if (connectedCallback) {
          connectedCallback();
        }
      }, 100);
    },
    on(event, callback) {
      if (connectedCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'connected') {
        throw Error('Only "connected" event is supported.');
      }
      connectedCallback = callback;
    },
    disconnect() {
      clearTimeout(timeout);
    }
  };
}
```

```js src/notifications.js
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme) {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

```css
label { display: block; margin-top: 10px; }
```

</Sandpack>

ржпржЦржи `roomId` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, chat ржЖржкржирж╛рж░ ржкрзНрж░рждрзНржпрж╛рж╢рж╛ ржЕржирзБржпрж╛ржпрж╝рзА ржкрзБржирж░рж╛ржпрж╝ рж╕ржВржпрзБржХрзНржд рж╣ржпрж╝ред ржХрж┐ржирзНрждрзБ ржпрзЗрж╣рзЗрждрзБ `theme` ржУ ржПржХржЯрж┐ dependency, chat *ржПржЫрж╛ржбрж╝рж╛ржУ* ржкрзНрж░рждрж┐ржмрж╛рж░ ржкрзБржирж░рж╛ржпрж╝ рж╕ржВржпрзБржХрзНржд рж╣ржпрж╝ ржпржЦржи ржЖржкржирж┐ dark ржПржмржВ light theme ржПрж░ ржоржзрзНржпрзЗ switch ржХрж░рзЗржиред ржПржЯрж╛ ржнрж╛рж▓рзЛ ржиржпрж╝!

ржЕржирзНржп ржХржерж╛ржпрж╝, ржЖржкржирж┐ *ржЪрж╛ржи ржирж╛* ржпрзЗ ржПржЗ рж▓рж╛ржЗржиржЯрж┐ reactive рж╣рзЛржХ, ржпржжрж┐ржУ ржПржЯрж┐ ржПржХржЯрж┐ Effect ржПрж░ ржнрж┐рждрж░рзЗ ржЖржЫрзЗ (ржпрж╛ reactive):

```js
      // ...
      showNotification('Connected!', theme);
      // ...
```

ржЖржкржирж╛рж░ ржПржЗ non-reactive logic ржХрзЗ ржПрж░ ржЪрж╛рж░ржкрж╛рж╢рзЗрж░ reactive Effect ржерзЗржХрзЗ ржЖрж▓рж╛ржжрж╛ ржХрж░рж╛рж░ ржПржХржЯрж┐ ржЙржкрж╛ржпрж╝ ржкрзНрж░ржпрж╝рзЛржЬржиред

### ржПржХржЯрж┐ Effect Event ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ {/*declaring-an-effect-event*/}

<Wip>

ржПржЗ ржЕржирзБржЪрзНржЫрзЗржжржЯрж┐ ржПржХржЯрж┐ **experimental API ржмрж░рзНржгржирж╛ ржХрж░рзЗ ржпрж╛ ржПржЦржиржУ React ржПрж░ ржПржХржЯрж┐ stable version ржП release рж╣ржпрж╝ржирж┐ред**

</Wip>

[`useEffectEvent`](/reference/react/experimental_useEffectEvent) ржирж╛ржоржХ ржПржХржЯрж┐ ржмрж┐рж╢рзЗрж╖ Hook ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи ржЖржкржирж╛рж░ Effect ржерзЗржХрзЗ ржПржЗ non-reactive logic ржмрзЗрж░ ржХрж░рждрзЗ:

```js {1,4-6}
import { useEffect, useEffectEvent } from 'react';

function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(() => {
    showNotification('Connected!', theme);
  });
  // ...
```

ржПржЦрж╛ржирзЗ, `onConnected` ржХрзЗ ржПржХржЯрж┐ *Effect Event* ржмрж▓рж╛ рж╣ржпрж╝ред ржПржЯрж┐ ржЖржкржирж╛рж░ Effect logic ржПрж░ ржПржХржЯрж┐ ржЕржВрж╢, ржХрж┐ржирзНрждрзБ ржПржЯрж┐ ржПржХржЯрж┐ event handler ржПрж░ ржорждрзЛ ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржЖржЪрж░ржг ржХрж░рзЗред ржПрж░ ржнрж┐рждрж░рзЗрж░ logic reactive ржиржпрж╝, ржПржмржВ ржПржЯрж┐ рж╕рж░рзНржмржжрж╛ ржЖржкржирж╛рж░ props ржПржмржВ state ржПрж░ рж╕рж░рзНржмрж╢рзЗрж╖ ржорж╛ржи "ржжрзЗржЦрзЗ"ред

ржПржЦржи ржЖржкржирж┐ ржЖржкржирж╛рж░ Effect ржПрж░ ржнрж┐рждрж░ ржерзЗржХрзЗ `onConnected` Effect Event ржХрж▓ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:


```js {2-4,9,13}
function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(() => {
    showNotification('Connected!', theme);
  });

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      onConnected();
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]); // тЬЕ рж╕ржорж╕рзНржд dependency ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
  // ...
```

ржПржЯрж┐ рж╕ржорж╕рзНржпрж╛рж░ рж╕ржорж╛ржзрж╛ржи ржХрж░рзЗред рж▓ржХрзНрж╖рзНржп ржХрж░рзБржи ржпрзЗ ржЖржкржирж╛ржХрзЗ ржЖржкржирж╛рж░ Effect ржПрж░ dependency ржПрж░ рждрж╛рж▓рж┐ржХрж╛ ржерзЗржХрзЗ `theme` *рж╕рж░рж╛рждрзЗ* рж╣ржпрж╝рзЗржЫрж┐рж▓, ржХрж╛рж░ржг ржПржЯрж┐ ржЖрж░ Effect ржП ржмрзНржпржмрж╣рзГржд рж╣ржЪрзНржЫрзЗ ржирж╛ред ржЖржкржирж╛ржХрзЗ ржПржЯрж┐рждрзЗ `onConnected` *ржпрзЛржЧ* ржХрж░рж╛рж░ржУ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗ, ржХрж╛рж░ржг **Effect Event reactive ржиржпрж╝ ржПржмржВ dependency ржерзЗржХрзЗ ржмрж╛ржж ржжрж┐рждрзЗ рж╣ржмрзЗред**

ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи ржпрзЗ ржирждрзБржи ржЖржЪрж░ржгржЯрж┐ ржЖржкржирж╛рж░ ржкрзНрж░рждрзНржпрж╛рж╢рж╛ ржЕржирзБржпрж╛ржпрж╝рзА ржХрж╛ржЬ ржХрж░рзЗ:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest",
    "toastify-js": "1.12.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';
import { createConnection, sendMessage } from './chat.js';
import { showNotification } from './notifications.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(() => {
    showNotification('Connected!', theme);
  });

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      onConnected();
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]);

  return <h1>Welcome to the {roomId} room!</h1>
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [isDark, setIsDark] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <label>
        <input
          type="checkbox"
          checked={isDark}
          onChange={e => setIsDark(e.target.checked)}
        />
        Use dark theme
      </label>
      <hr />
      <ChatRoom
        roomId={roomId}
        theme={isDark ? 'dark' : 'light'}
      />
    </>
  );
}
```

```js src/chat.js
export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  let connectedCallback;
  let timeout;
  return {
    connect() {
      timeout = setTimeout(() => {
        if (connectedCallback) {
          connectedCallback();
        }
      }, 100);
    },
    on(event, callback) {
      if (connectedCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'connected') {
        throw Error('Only "connected" event is supported.');
      }
      connectedCallback = callback;
    },
    disconnect() {
      clearTimeout(timeout);
    }
  };
}
```

```js src/notifications.js hidden
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme) {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

```css
label { display: block; margin-top: 10px; }
```

</Sandpack>

ржЖржкржирж┐ Effect Event ржХрзЗ event handler ржПрж░ ржЦрзБржм ржЕржирзБрж░рзВржк рж╣рж┐рж╕рж╛ржмрзЗ ржнрж╛ржмрждрзЗ ржкрж╛рж░рзЗржиред ржкрзНрж░ржзрж╛ржи ржкрж╛рж░рзНржержХрзНржп рж╣рж▓ ржпрзЗ event handler user interaction ржПрж░ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝, ржпрзЗржЦрж╛ржирзЗ Effect Event ржЖржкржирж╛рж░ ржжрзНржмрж╛рж░рж╛ Effect ржерзЗржХрзЗ trigger ржХрж░рж╛ рж╣ржпрж╝ред Effect Event ржЖржкржирж╛ржХрзЗ Effect ржПрж░ reactivity ржПржмржВ ржпрзЗ ржХрзЛржб reactive рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржиржпрж╝ рждрж╛рж░ ржоржзрзНржпрзЗ "chain ржнрж╛ржЩрждрзЗ" ржжрзЗржпрж╝ред

### Effect Event ржжрж┐ржпрж╝рзЗ рж╕рж░рзНржмрж╢рзЗрж╖ props ржПржмржВ state ржкржбрж╝рж╛ {/*reading-latest-props-and-state-with-effect-events*/}

<Wip>

ржПржЗ ржЕржирзБржЪрзНржЫрзЗржжржЯрж┐ ржПржХржЯрж┐ **experimental API ржмрж░рзНржгржирж╛ ржХрж░рзЗ ржпрж╛ ржПржЦржиржУ React ржПрж░ ржПржХржЯрж┐ stable version ржП release рж╣ржпрж╝ржирж┐ред**

</Wip>

Effect Event ржЖржкржирж╛ржХрзЗ ржЕржирзЗржХ pattern ржарж┐ржХ ржХрж░рждрзЗ ржжрзЗржпрж╝ ржпрзЗржЦрж╛ржирзЗ ржЖржкржирж┐ dependency linter suppress ржХрж░рждрзЗ ржкрзНрж░рж▓рзБржмрзНржз рж╣рждрзЗ ржкрж╛рж░рзЗржиред

ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржзрж░рзБржи ржЖржкржирж╛рж░ ржПржХржЯрж┐ Effect ржЖржЫрзЗ page visit log ржХрж░рж╛рж░ ржЬржирзНржп:

```js
function Page() {
  useEffect(() => {
    logVisit();
  }, []);
  // ...
}
```

ржкрж░рзЗ, ржЖржкржирж┐ ржЖржкржирж╛рж░ site ржП ржПржХрж╛ржзрж┐ржХ route ржпрзЛржЧ ржХрж░рзЗржиред ржПржЦржи ржЖржкржирж╛рж░ `Page` ржХржорзНржкрзЛржирзЗржирзНржЯ ржмрж░рзНрждржорж╛ржи path рж╕рж╣ ржПржХржЯрж┐ `url` prop ржкрж╛ржпрж╝ред ржЖржкржирж┐ ржЖржкржирж╛рж░ `logVisit` call ржПрж░ ржЕржВрж╢ рж╣рж┐рж╕рж╛ржмрзЗ `url` pass ржХрж░рждрзЗ ржЪрж╛ржи, ржХрж┐ржирзНрждрзБ dependency linter ржЕржнрж┐ржпрзЛржЧ ржХрж░рзЗ:

```js {1,3}
function Page({ url }) {
  useEffect(() => {
    logVisit(url);
  }, []); // ЁЯФ┤ React Hook useEffect has a missing dependency: 'url'
  // ...
}
```

ржХрзЛржбржЯрж┐ ржХрж┐ ржХрж░рждрзЗ ржЪрж╛ржпрж╝ рждрж╛ ржирж┐ржпрж╝рзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рзБржиред ржЖржкржирж┐ ржмрж┐ржнрж┐ржирзНржи URL ржПрж░ ржЬржирзНржп ржПржХржЯрж┐ ржкрзГржержХ visit log ржХрж░рждрзЗ *ржЪрж╛ржи* ржХрж╛рж░ржг ржкрзНрж░рждрж┐ржЯрж┐ URL ржПржХржЯрж┐ ржнрж┐ржирзНржи page ржкрзНрж░рждрж┐ржирж┐ржзрж┐рждрзНржм ржХрж░рзЗред ржЕржирзНржп ржХржерж╛ржпрж╝, ржПржЗ `logVisit` call `url` ржПрж░ рж╕рж╛ржкрзЗржХрзНрж╖рзЗ reactive *рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд*ред ржПржЗ ржХрж╛рж░ржгрзЗ, ржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ, dependency linter ржЕржирзБрж╕рж░ржг ржХрж░рж╛ ржПржмржВ `url` ржХрзЗ ржПржХржЯрж┐ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржпрзЛржЧ ржХрж░рж╛ ржмрзЛржзржЧржорзНржп:

```js {4}
function Page({ url }) {
  useEffect(() => {
    logVisit(url);
  }, [url]); // тЬЕ рж╕ржорж╕рзНржд dependency ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
  // ...
}
```

ржПржЦржи ржзрж░рзБржи ржЖржкржирж┐ ржкрзНрж░рждрж┐ржЯрж┐ page visit ржПрж░ рж╕рж╛ржерзЗ shopping cart ржП item ржПрж░ рж╕ржВржЦрзНржпрж╛ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рждрзЗ ржЪрж╛ржи:


```js {2-3,6}
function Page({ url }) {
  const { items } = useContext(ShoppingCartContext);
  const numberOfItems = items.length;

  useEffect(() => {
    logVisit(url, numberOfItems);
  }, [url]); // ЁЯФ┤ React Hook useEffect has a missing dependency: 'numberOfItems'
  // ...
}
```

ржЖржкржирж┐ Effect ржПрж░ ржнрж┐рждрж░рзЗ `numberOfItems` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржЫрзЗржи, рждрж╛ржЗ linter ржЖржкржирж╛ржХрзЗ ржПржЯрж┐ ржПржХржЯрж┐ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржпрзЛржЧ ржХрж░рждрзЗ ржмрж▓рзЗред рждржмрзЗ, ржЖржкржирж┐ *ржЪрж╛ржи ржирж╛* ржпрзЗ `logVisit` call `numberOfItems` ржПрж░ рж╕рж╛ржкрзЗржХрзНрж╖рзЗ reactive рж╣рзЛржХред ржпржжрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА shopping cart ржП ржХрж┐ржЫрзБ рж░рж╛ржЦрзЗ, ржПржмржВ `numberOfItems` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржПрж░ *ржорж╛ржирзЗ ржПржЗ ржиржпрж╝* ржпрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЖржмрж╛рж░ page ржЯрж┐ visit ржХрж░рзЗржЫрзЗред ржЕржирзНржп ржХржерж╛ржпрж╝, *page visit ржХрж░рж╛* рж╣рж▓, ржХрж┐ржЫрзБ ржЕрж░рзНржерзЗ, ржПржХржЯрж┐ "event"ред ржПржЯрж┐ рж╕ржоржпрж╝рзЗрж░ ржПржХржЯрж┐ рж╕рзБржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорзБрж╣рзВрж░рзНрждрзЗ ржШржЯрзЗред

ржХрзЛржбржЯрж┐ ржжрзБржЯрж┐ ржЕржВрж╢рзЗ ржмрж┐ржнржХрзНржд ржХрж░рзБржи:

```js {5-7,10}
function Page({ url }) {
  const { items } = useContext(ShoppingCartContext);
  const numberOfItems = items.length;

  const onVisit = useEffectEvent(visitedUrl => {
    logVisit(visitedUrl, numberOfItems);
  });

  useEffect(() => {
    onVisit(url);
  }, [url]); // тЬЕ рж╕ржорж╕рзНржд dependency ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
  // ...
}
```

ржПржЦрж╛ржирзЗ, `onVisit` ржПржХржЯрж┐ Effect Eventред ржПрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб reactive ржиржпрж╝ред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржЖржкржирж┐ `numberOfItems` (ржмрж╛ ржЕржирзНржп ржХрзЛржирзЛ reactive value!) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржЪрж┐ржирзНрждрж╛ ржирж╛ ржХрж░рзЗ ржпрзЗ ржПржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ рж╕ржоржпрж╝ ржЖрж╢рзЗржкрж╛рж╢рзЗрж░ ржХрзЛржб ржкрзБржирж░рж╛ржпрж╝ execute рж╣ржмрзЗред

ржЕржирзНржпржжрж┐ржХрзЗ, Effect ржирж┐ржЬрзЗржЗ reactive ржерж╛ржХрзЗред Effect ржПрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб `url` prop ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, рждрж╛ржЗ Effect ржкрзНрж░рждрж┐ржЯрж┐ re-render ржПрж░ ржкрж░рзЗ ржПржХржЯрж┐ ржнрж┐ржирзНржи `url` ржжрж┐ржпрж╝рзЗ ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржмрзЗред ржПржЯрж┐, ржкрж░рж┐ржмрж░рзНрждрзЗ, `onVisit` Effect Event ржХрж▓ ржХрж░ржмрзЗред

ржлрж▓рж╕рзНржмрж░рзВржк, ржЖржкржирж┐ `url` ржПрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржЬржирзНржп `logVisit` ржХрж▓ ржХрж░ржмрзЗржи, ржПржмржВ рж╕рж░рзНржмржжрж╛ рж╕рж░рзНржмрж╢рзЗрж╖ `numberOfItems` ржкржбрж╝ржмрзЗржиред рждржмрзЗ, ржпржжрж┐ `numberOfItems` ржирж┐ржЬрзЗ ржерзЗржХрзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржПржЯрж┐ ржХрзЛржирзЛ ржХрзЛржб ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ ржХрж░ржмрзЗ ржирж╛ред

<Note>

ржЖржкржирж┐ рж╣ржпрж╝рждрзЛ ржнрж╛ржмржЫрзЗржи ржЖржкржирж┐ ржХрж┐ ржХрзЛржирзЛ argument ржЫрж╛ржбрж╝рж╛ржЗ `onVisit()` ржХрж▓ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ ржПрж░ ржнрж┐рждрж░рзЗ `url` ржкржбрж╝рждрзЗ ржкрж╛рж░рзЗржи:

```js {2,6}
  const onVisit = useEffectEvent(() => {
    logVisit(url, numberOfItems);
  });

  useEffect(() => {
    onVisit();
  }, [url]);
```

ржПржЯрж┐ ржХрж╛ржЬ ржХрж░ржмрзЗ, ржХрж┐ржирзНрждрзБ ржПржЗ `url` ржЯрж┐ ржЖржкржирж╛рж░ Effect Event ржП рж╕рзНржкрж╖рзНржЯржнрж╛ржмрзЗ pass ржХрж░рж╛ ржнрж╛рж▓рзЛред **ржЖржкржирж╛рж░ Effect Event ржП argument рж╣рж┐рж╕рж╛ржмрзЗ `url` pass ржХрж░рзЗ, ржЖржкржирж┐ ржмрж▓ржЫрзЗржи ржпрзЗ ржПржХржЯрж┐ ржнрж┐ржирзНржи `url` ржжрж┐ржпрж╝рзЗ ржПржХржЯрж┐ page visit ржХрж░рж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ ржПржХржЯрж┐ ржкрзГржержХ "event" ржЧржаржи ржХрж░рзЗред** `visitedUrl` рж╣рж▓ ржШржЯрзЗ ржпрж╛ржУржпрж╝рж╛ "event" ржПрж░ ржПржХржЯрж┐ *ржЕржВрж╢*:

```js {1-2,6}
  const onVisit = useEffectEvent(visitedUrl => {
    logVisit(visitedUrl, numberOfItems);
  });

  useEffect(() => {
    onVisit(url);
  }, [url]);
```

ржпрзЗрж╣рзЗрждрзБ ржЖржкржирж╛рж░ Effect Event рж╕рзНржкрж╖рзНржЯржнрж╛ржмрзЗ `visitedUrl` ржПрж░ ржЬржирзНржп "ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛" ржХрж░рзЗ, ржПржЦржи ржЖржкржирж┐ ржнрзБрж▓ржмрж╢ржд Effect ржПрж░ dependency ржерзЗржХрзЗ `url` рж╕рж░рж╛рждрзЗ ржкрж╛рж░ржмрзЗржи ржирж╛ред ржпржжрж┐ ржЖржкржирж┐ `url` dependency рж╕рж░рж╛ржи (distinct page visit ржХрзЗ ржПржХржЯрж┐ рж╣рж┐рж╕рж╛ржмрзЗ ржЧржгржирж╛ ржХрж░рж╛ рж╣ржпрж╝), linter ржЖржкржирж╛ржХрзЗ ржПржЯрж┐ рж╕ржорзНржкрж░рзНржХрзЗ рж╕рждрж░рзНржХ ржХрж░ржмрзЗред ржЖржкржирж┐ ржЪрж╛ржи `onVisit` `url` ржПрж░ рж╕рж╛ржкрзЗржХрзНрж╖рзЗ reactive рж╣рзЛржХ, рждрж╛ржЗ ржПрж░ ржнрж┐рждрж░рзЗ `url` ржкржбрж╝рж╛рж░ ржкрж░рж┐ржмрж░рзНрждрзЗ (ржпрзЗржЦрж╛ржирзЗ ржПржЯрж┐ reactive рж╣ржмрзЗ ржирж╛), ржЖржкржирж┐ ржПржЯрж┐ ржЖржкржирж╛рж░ Effect *ржерзЗржХрзЗ* pass ржХрж░рзЗржиред

ржПржЯрж┐ ржмрж┐рж╢рзЗрж╖ржнрж╛ржмрзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рж╣ржпрж╝рзЗ ржУржарзЗ ржпржжрж┐ Effect ржПрж░ ржнрж┐рждрж░рзЗ ржХрж┐ржЫрзБ asynchronous logic ржерж╛ржХрзЗ:

```js {6,8}
  const onVisit = useEffectEvent(visitedUrl => {
    logVisit(visitedUrl, numberOfItems);
  });

  useEffect(() => {
    setTimeout(() => {
      onVisit(url);
    }, 5000); // visit log ржХрж░рж╛ delay ржХрж░рзБржи
  }, [url]);
```

ржПржЦрж╛ржирзЗ, `onVisit` ржПрж░ ржнрж┐рждрж░рзЗ `url` *рж╕рж░рзНржмрж╢рзЗрж╖* `url` ржПрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рзЗ ржпрж╛ржпрж╝ (ржпрж╛ ржЗрждрж┐ржоржзрзНржпрзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рждрзЗ ржкрж╛рж░рзЗ), ржХрж┐ржирзНрждрзБ `visitedUrl` рж╕рзЗржЗ `url` ржПрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рзЗ ржпрж╛ржпрж╝ ржпрж╛ ржорзВрж▓ржд ржПржЗ Effect (ржПржмржВ ржПржЗ `onVisit` call) ржЪрж╛рж▓рзБ ржХрж░рзЗржЫрж┐рж▓ред

</Note>

<DeepDive>

#### ржкрж░рж┐ржмрж░рзНрждрзЗ dependency linter suppress ржХрж░рж╛ ржХрж┐ ржарж┐ржХ? {/*is-it-okay-to-suppress-the-dependency-linter-instead*/}

ржмрж┐ржжрзНржпржорж╛ржи codebase ржЧрзБрж▓рж┐рждрзЗ, ржЖржкржирж┐ ржХржЦржиржУ ржХржЦржиржУ ржПржЗржнрж╛ржмрзЗ lint rule suppress ржХрж░рж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗржи:

```js {7-9}
function Page({ url }) {
  const { items } = useContext(ShoppingCartContext);
  const numberOfItems = items.length;

  useEffect(() => {
    logVisit(url, numberOfItems);
    // ЁЯФ┤ ржПржЗржнрж╛ржмрзЗ linter suppress ржХрж░рж╛ ржПржбрж╝рж┐ржпрж╝рзЗ ржЪрж▓рзБржи:
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [url]);
  // ...
}
```

`useEffectEvent` React ржПрж░ ржПржХржЯрж┐ stable ржЕржВрж╢ рж╣ржпрж╝рзЗ ржЧрзЗрж▓рзЗ, ржЖржорж░рж╛ рж╕рзБржкрж╛рж░рж┐рж╢ ржХрж░рж┐ **ржХржЦржиржУ linter suppress ржХрж░ржмрзЗржи ржирж╛**ред

Rule suppress ржХрж░рж╛рж░ ржкрзНрж░ржержо ржЕрж╕рзБржмрж┐ржзрж╛ рж╣рж▓ ржпрзЗ React ржЖрж░ ржЖржкржирж╛ржХрзЗ рж╕рждрж░рзНржХ ржХрж░ржмрзЗ ржирж╛ ржпржЦржи ржЖржкржирж╛рж░ Effect ржХрзЗ ржПржХржЯрж┐ ржирждрзБржи reactive dependency ржПрж░ ржкрзНрж░рждрж┐ "react" ржХрж░рждрзЗ рж╣ржмрзЗ ржпрж╛ ржЖржкржирж┐ ржЖржкржирж╛рж░ ржХрзЛржбрзЗ introduce ржХрж░рзЗржЫрзЗржиред ржЖржЧрзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗ, ржЖржкржирж┐ dependency рждрзЗ `url` ржпрзЛржЧ ржХрж░рзЗржЫрж┐рж▓рзЗржи *ржХрж╛рж░ржг* React ржЖржкржирж╛ржХрзЗ ржПржЯрж┐ ржХрж░рждрзЗ ржоржирзЗ ржХрж░рж┐ржпрж╝рзЗ ржжрж┐ржпрж╝рзЗржЫрж┐рж▓ред ржЖржкржирж┐ linter disable ржХрж░рж▓рзЗ рж╕рзЗржЗ Effect ржП ржнржмрж┐рж╖рзНржпрждрзЗрж░ ржХрзЛржирзЛ edit ржПрж░ ржЬржирзНржп ржЖрж░ ржПржЗ ржзрж░ржирзЗрж░ reminder ржкрж╛ржмрзЗржи ржирж╛ред ржПржЯрж┐ bug ржПрж░ ржжрж┐ржХрзЗ ржирж┐ржпрж╝рзЗ ржпрж╛ржпрж╝ред

ржПржЦрж╛ржирзЗ linter suppress ржХрж░рж╛рж░ ржХрж╛рж░ржгрзЗ рж╕рзГрж╖рзНржЯ ржПржХржЯрж┐ ржмрж┐ржнрзНрж░рж╛ржирзНрждрж┐ржХрж░ bug ржПрж░ ржЙржжрж╛рж╣рж░ржгред ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, `handleMove` function ржЯрж┐ ржмрж░рзНрждржорж╛ржи `canMove` state variable ржорж╛ржи ржкржбрж╝рж╛рж░ ржХржерж╛ ржпрж╛рждрзЗ dot cursor ржЕржирзБрж╕рж░ржг ржХрж░ржмрзЗ ржХрж┐ржирж╛ рждрж╛ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирж┐рждрзЗ ржкрж╛рж░рзЗред рждржмрзЗ, `handleMove` ржПрж░ ржнрж┐рждрж░рзЗ `canMove` рж╕рж░рзНржмржжрж╛ `true`ред

ржЖржкржирж┐ ржХрж┐ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗржи ржХрзЗржи?


<Sandpack>

```js
import { useState, useEffect } from 'react';

export default function App() {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  const [canMove, setCanMove] = useState(true);

  function handleMove(e) {
    if (canMove) {
      setPosition({ x: e.clientX, y: e.clientY });
    }
  }

  useEffect(() => {
    window.addEventListener('pointermove', handleMove);
    return () => window.removeEventListener('pointermove', handleMove);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  return (
    <>
      <label>
        <input type="checkbox"
          checked={canMove}
          onChange={e => setCanMove(e.target.checked)}
        />
        The dot is allowed to move
      </label>
      <hr />
      <div style={{
        position: 'absolute',
        backgroundColor: 'pink',
        borderRadius: '50%',
        opacity: 0.6,
        transform: `translate(${position.x}px, ${position.y}px)`,
        pointerEvents: 'none',
        left: -20,
        top: -20,
        width: 40,
        height: 40,
      }} />
    </>
  );
}
```

```css
body {
  height: 200px;
}
```

</Sandpack>

ржПржЗ ржХрзЛржбрзЗрж░ рж╕ржорж╕рзНржпрж╛ рж╣рж▓ dependency linter suppress ржХрж░рж╛ред ржпржжрж┐ ржЖржкржирж┐ suppression рж╕рж░рж╛ржи, ржЖржкржирж┐ ржжрзЗржЦржмрзЗржи ржпрзЗ ржПржЗ Effect `handleMove` function ржПрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рж╛ ржЙржЪрж┐рждред ржПржЯрж┐ ржмрзЛржзржЧржорзНржп: `handleMove` component body ржПрж░ ржнрж┐рждрж░рзЗ ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ, ржпрж╛ ржПржЯрж┐ржХрзЗ ржПржХржЯрж┐ reactive value ржХрж░рзЗ рждрзЛрж▓рзЗред ржкрзНрж░рждрж┐ржЯрж┐ reactive value ржЕржмрж╢рзНржпржЗ ржПржХржЯрж┐ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ, ржЕржержмрж╛ ржПржЯрж┐ рж╕ржоржпрж╝рзЗрж░ рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ stale рж╣рждрзЗ ржкрж╛рж░рзЗ!

ржорзВрж▓ ржХрзЛржбрзЗрж░ рж▓рзЗржЦржХ React ржХрзЗ "ржорж┐ржерзНржпрж╛ ржмрж▓рзЗржЫрзЗржи" ржпрзЗ Effect ржХрзЛржирзЛ reactive value ржПрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ ржирж╛ (`[]`)ред ржПржЗ ржХрж╛рж░ржгрзЗржЗ React `canMove` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржУржпрж╝рж╛рж░ ржкрж░рзЗ (ржПржмржВ ржПрж░ рж╕рж╛ржерзЗ `handleMove`) Effect ржкрзБржирж░рж╛ржпрж╝ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рзЗржирж┐ред ржХрж╛рж░ржг React Effect ржкрзБржирж░рж╛ржпрж╝ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рзЗржирж┐, listener рж╣рж┐рж╕рж╛ржмрзЗ attached `handleMove` рж╣рж▓ initial render ржПрж░ рж╕ржоржпрж╝ рждрзИрж░рж┐ `handleMove` functionред Initial render ржПрж░ рж╕ржоржпрж╝, `canMove` ржЫрж┐рж▓ `true`, ржпрзЗ ржХрж╛рж░ржгрзЗ initial render ржерзЗржХрзЗ `handleMove` ржЪрж┐рж░ржХрж╛рж▓ рж╕рзЗржЗ ржорж╛ржи ржжрзЗржЦржмрзЗред

**ржпржжрж┐ ржЖржкржирж┐ ржХржЦржиржУ linter suppress ржирж╛ ржХрж░рзЗржи, ржЖржкржирж┐ ржХржЦржиржУ stale value ржПрж░ рж╕ржорж╕рзНржпрж╛ ржжрзЗржЦржмрзЗржи ржирж╛ред**

`useEffectEvent` ржПрж░ рж╕рж╛ржерзЗ, linter ржХрзЗ "ржорж┐ржерзНржпрж╛ ржмрж▓рж╛рж░" ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗ, ржПржмржВ ржХрзЛржбржЯрж┐ ржЖржкржирж╛рж░ ржкрзНрж░рждрзНржпрж╛рж╢рж╛ ржЕржирзБржпрж╛ржпрж╝рзА ржХрж╛ржЬ ржХрж░рзЗ:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export default function App() {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  const [canMove, setCanMove] = useState(true);

  const onMove = useEffectEvent(e => {
    if (canMove) {
      setPosition({ x: e.clientX, y: e.clientY });
    }
  });

  useEffect(() => {
    window.addEventListener('pointermove', onMove);
    return () => window.removeEventListener('pointermove', onMove);
  }, []);

  return (
    <>
      <label>
        <input type="checkbox"
          checked={canMove}
          onChange={e => setCanMove(e.target.checked)}
        />
        The dot is allowed to move
      </label>
      <hr />
      <div style={{
        position: 'absolute',
        backgroundColor: 'pink',
        borderRadius: '50%',
        opacity: 0.6,
        transform: `translate(${position.x}px, ${position.y}px)`,
        pointerEvents: 'none',
        left: -20,
        top: -20,
        width: 40,
        height: 40,
      }} />
    </>
  );
}
```

```css
body {
  height: 200px;
}
```

</Sandpack>

ржПрж░ ржорж╛ржирзЗ ржПржЗ ржиржпрж╝ ржпрзЗ `useEffectEvent` *рж╕рж░рзНржмржжрж╛* рж╕ржарж┐ржХ рж╕ржорж╛ржзрж╛ржиред ржЖржкржирж╛рж░ рж╢рзБржзрзБржорж╛рждрзНрж░ рж╕рзЗржЗ ржХрзЛржбрзЗрж░ рж▓рж╛ржЗржиржЧрзБрж▓рж┐рждрзЗ ржПржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржЙржЪрж┐ржд ржпрж╛ ржЖржкржирж┐ reactive рж╣рждрзЗ ржЪрж╛ржи ржирж╛ред ржЙржкрж░рзЗрж░ sandbox ржП, ржЖржкржирж┐ ржЪрж╛ржиржирж┐ ржпрзЗ Effect ржПрж░ ржХрзЛржб `canMove` ржПрж░ рж╕рж╛ржкрзЗржХрзНрж╖рзЗ reactive рж╣рзЛржХред

[Effect Dependency рж╕рж░рж╛ржирзЛ](/learn/removing-effect-dependencies) ржкржбрж╝рзБржи linter suppress ржХрж░рж╛рж░ ржЕржирзНржпрж╛ржирзНржп рж╕ржарж┐ржХ ржмрж┐ржХрж▓рзНржкрзЗрж░ ржЬржирзНржпред

</DeepDive>

### Effect Event ржПрж░ рж╕рзАржорж╛ржмржжрзНржзрждрж╛ {/*limitations-of-effect-events*/}

<Wip>

ржПржЗ ржЕржирзБржЪрзНржЫрзЗржжржЯрж┐ ржПржХржЯрж┐ **experimental API ржмрж░рзНржгржирж╛ ржХрж░рзЗ ржпрж╛ ржПржЦржиржУ React ржПрж░ ржПржХржЯрж┐ stable version ржП release рж╣ржпрж╝ржирж┐ред**

</Wip>

Effect Event ржЖржкржирж┐ ржХрж┐ржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи рждрж╛рждрзЗ ржЦрзБржмржЗ рж╕рзАржорж┐ржд:

* **рж╢рзБржзрзБржорж╛рждрзНрж░ Effect ржПрж░ ржнрж┐рждрж░ ржерзЗржХрзЗ рждрж╛ржжрзЗрж░ ржХрж▓ ржХрж░рзБржиред**
* **ржХржЦржиржУ рждрж╛ржжрзЗрж░ ржЕржирзНржп ржХржорзНржкрзЛржирзЗржирзНржЯ ржмрж╛ Hook ржП pass ржХрж░ржмрзЗржи ржирж╛ред**

ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржПржЗржнрж╛ржмрзЗ ржПржХржЯрж┐ Effect Event ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржПржмржВ pass ржХрж░ржмрзЗржи ржирж╛:

```js {4-6,8}
function Timer() {
  const [count, setCount] = useState(0);

  const onTick = useEffectEvent(() => {
    setCount(count + 1);
  });

  useTimer(onTick, 1000); // ЁЯФ┤ ржПржбрж╝рж┐ржпрж╝рзЗ ржЪрж▓рзБржи: Effect Event pass ржХрж░рж╛

  return <h1>{count}</h1>
}

function useTimer(callback, delay) {
  useEffect(() => {
    const id = setInterval(() => {
      callback();
    }, delay);
    return () => {
      clearInterval(id);
    };
  }, [delay, callback]); // dependency рждрзЗ "callback" ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ
}
```

ржкрж░рж┐ржмрж░рзНрждрзЗ, рж╕рж░рзНржмржжрж╛ Effect Event рж╕рж░рж╛рж╕рж░рж┐ рж╕рзЗржЗ Effect ржПрж░ ржкрж╛рж╢рзЗ ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рзБржи ржпрж╛ рждрж╛ржжрзЗрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:


```js {10-12,16,21}
function Timer() {
  const [count, setCount] = useState(0);
  useTimer(() => {
    setCount(count + 1);
  }, 1000);
  return <h1>{count}</h1>
}

function useTimer(callback, delay) {
  const onTick = useEffectEvent(() => {
    callback();
  });

  useEffect(() => {
    const id = setInterval(() => {
      onTick(); // тЬЕ ржнрж╛рж▓рзЛ: рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ Effect ржПрж░ ржнрж┐рждрж░рзЗ locally ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝
    }, delay);
    return () => {
      clearInterval(id);
    };
  }, [delay]); // "onTick" (ржПржХржЯрж┐ Effect Event) ржХрзЗ dependency рж╣рж┐рж╕рж╛ржмрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рж╛рж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗ
}
```

Effect Event рж╣рж▓ ржЖржкржирж╛рж░ Effect ржХрзЛржбрзЗрж░ non-reactive "pieces"ред рждрж╛ржжрзЗрж░ рж╕рзЗржЗ Effect ржПрж░ ржкрж╛рж╢рзЗ ржерж╛ржХрж╛ ржЙржЪрж┐ржд ржпрж╛ рждрж╛ржжрзЗрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

<Recap>

- Event handler ржирж┐рж░рзНржжрж┐рж╖рзНржЯ interaction ржПрж░ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛ржпрж╝ ржЪрж╛рж▓рзБ рж╣ржпрж╝ред
- Effect ржпржЦржиржЗ synchronization ржкрзНрж░ржпрж╝рзЛржЬржи рждржЦржи ржЪрж╛рж▓рзБ рж╣ржпрж╝ред
- Event handler ржПрж░ ржнрж┐рждрж░рзЗрж░ logic reactive ржиржпрж╝ред
- Effect ржПрж░ ржнрж┐рждрж░рзЗрж░ logic reactiveред
- ржЖржкржирж┐ Effect ржерзЗржХрзЗ non-reactive logic Effect Event ржП рж╕рж░рж╛рждрзЗ ржкрж╛рж░рзЗржиред
- рж╢рзБржзрзБржорж╛рждрзНрж░ Effect ржПрж░ ржнрж┐рждрж░ ржерзЗржХрзЗ Effect Event ржХрж▓ ржХрж░рзБржиред
- Effect Event ржЕржирзНржп ржХржорзНржкрзЛржирзЗржирзНржЯ ржмрж╛ Hook ржП pass ржХрж░ржмрзЗржи ржирж╛ред

</Recap>

<Challenges>

#### ржПржХржЯрж┐ variable ржарж┐ржХ ржХрж░рзБржи ржпрж╛ update рж╣ржЪрзНржЫрзЗ ржирж╛ {/*fix-a-variable-that-doesnt-update*/}

ржПржЗ `Timer` ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржХржЯрж┐ `count` state variable рж░рж╛ржЦрзЗ ржпрж╛ ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржмрзГржжрзНржзрж┐ ржкрж╛ржпрж╝ред ржпрзЗ ржорж╛ржи ржжрзНржмрж╛рж░рж╛ ржПржЯрж┐ ржмрзГржжрзНржзрж┐ ржкрж╛ржЪрзНржЫрзЗ рждрж╛ `increment` state variable ржП рж╕ржВрж░ржХрзНрж╖рж┐рждред ржЖржкржирж┐ plus ржПржмржВ minus button ржжрж┐ржпрж╝рзЗ `increment` variable ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

рждржмрзЗ, ржЖржкржирж┐ ржпрждржмрж╛рж░ржЗ plus button ржХрзНрж▓рж┐ржХ ржХрж░рзБржи ржирж╛ ржХрзЗржи, counter ржПржЦржиржУ ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржПржХ ржХрж░рзЗ ржмрзГржжрзНржзрж┐ ржкрж╛ржЪрзНржЫрзЗред ржПржЗ ржХрзЛржбрзЗрж░ рж╕рж╛ржерзЗ ржХрж┐ рж╕ржорж╕рзНржпрж╛? ржХрзЗржи Effect ржПрж░ ржХрзЛржбрзЗрж░ ржнрж┐рждрж░рзЗ `increment` рж╕рж░рзНржмржжрж╛ `1` ржПрж░ рж╕ржорж╛ржи? ржнрзБрж▓ржЯрж┐ ржЦрзБржБржЬрзБржи ржПржмржВ ржарж┐ржХ ржХрж░рзБржиред

<Hint>

ржПржЗ ржХрзЛржб ржарж┐ржХ ржХрж░рждрзЗ, ржирж┐ржпрж╝ржо ржЕржирзБрж╕рж░ржг ржХрж░рж╛ржЗ ржпржерзЗрж╖рзНржЯред

</Hint>

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```


```js
import { useState, useEffect } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);

  useEffect(() => {
    const id = setInterval(() => {
      setCount(c => c + increment);
    }, 1000);
    return () => {
      clearInterval(id);
    };
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Every second, increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
    </>
  );
}
```

```css
button { margin: 10px; }
```

</Sandpack>

<Solution>

ржпржерж╛рж░рзАрждрж┐, ржпржЦржи ржЖржкржирж┐ Effect ржП bug ржЦрзБржБржЬржЫрзЗржи, linter suppression ржЦрзЛржБржЬрж╛ ржжрж┐ржпрж╝рзЗ рж╢рзБрж░рзБ ржХрж░рзБржиред

ржпржжрж┐ ржЖржкржирж┐ suppression comment рж╕рж░рж╛ржи, React ржЖржкржирж╛ржХрзЗ ржмрж▓ржмрзЗ ржпрзЗ ржПржЗ Effect ржПрж░ ржХрзЛржб `increment` ржПрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ ржЖржкржирж┐ React ржХрзЗ "ржорж┐ржерзНржпрж╛ ржмрж▓рзЗржЫрзЗржи" ржпрзЗ ржПржЗ Effect ржХрзЛржирзЛ reactive value ржПрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ ржирж╛ (`[]`)ред dependency array рждрзЗ `increment` ржпрзЛржЧ ржХрж░рзБржи:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);

  useEffect(() => {
    const id = setInterval(() => {
      setCount(c => c + increment);
    }, 1000);
    return () => {
      clearInterval(id);
    };
  }, [increment]);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Every second, increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
    </>
  );
}
```

```css
button { margin: 10px; }
```

</Sandpack>

ржПржЦржи, ржпржЦржи `increment` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, React ржЖржкржирж╛рж░ Effect ржкрзБржирж░рж╛ржпрж╝ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░ржмрзЗ, ржпрж╛ interval restart ржХрж░ржмрзЗред

</Solution>

#### ржПржХржЯрж┐ freezing counter ржарж┐ржХ ржХрж░рзБржи {/*fix-a-freezing-counter*/}

ржПржЗ `Timer` ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржХржЯрж┐ `count` state variable рж░рж╛ржЦрзЗ ржпрж╛ ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржмрзГржжрзНржзрж┐ ржкрж╛ржпрж╝ред ржпрзЗ ржорж╛ржи ржжрзНржмрж╛рж░рж╛ ржПржЯрж┐ ржмрзГржжрзНржзрж┐ ржкрж╛ржЪрзНржЫрзЗ рждрж╛ `increment` state variable ржП рж╕ржВрж░ржХрзНрж╖рж┐ржд, ржпрж╛ ржЖржкржирж┐ plus ржПржмржВ minus button ржжрж┐ржпрж╝рзЗ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, plus button ржиржпрж╝ржмрж╛рж░ ржЪрж╛ржкрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи, ржПржмржВ рж▓ржХрзНрж╖рзНржп ржХрж░рзБржи ржпрзЗ `count` ржПржЦржи ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржПржХ ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ ржжрж╢ ржХрж░рзЗ ржмрзГржжрзНржзрж┐ ржкрж╛ржЪрзНржЫрзЗред

ржПржЗ user interface ржПрж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржЫрзЛржЯ рж╕ржорж╕рзНржпрж╛ ржЖржЫрзЗред ржЖржкржирж┐ рж╣ржпрж╝рждрзЛ рж▓ржХрзНрж╖рзНржп ржХрж░ржмрзЗржи ржпрзЗ ржЖржкржирж┐ ржпржжрж┐ ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржПржХржмрж╛рж░рзЗрж░ ржЪрзЗржпрж╝рзЗ ржжрзНрж░рзБржд plus ржмрж╛ minus button ржЪрж╛ржкрждрзЗ ржерж╛ржХрзЗржи, timer ржирж┐ржЬрзЗржЗ pause рж╣ржпрж╝рзЗ ржпрж╛ржЪрзНржЫрзЗ ржмрж▓рзЗ ржоржирзЗ рж╣ржпрж╝ред ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЖржкржирж┐ рж╢рзЗрж╖ржмрж╛рж░ ржпрзЗржХрзЛржирзЛ button ржЪрж╛ржкрж╛рж░ ржПржХ рж╕рзЗржХрзЗржирзНржб ржкрж░рзЗ resume рж╣ржпрж╝ред ржХрзЗржи ржПржЯрж┐ ржШржЯржЫрзЗ рждрж╛ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзБржи, ржПржмржВ рж╕ржорж╕рзНржпрж╛ржЯрж┐ ржарж┐ржХ ржХрж░рзБржи ржпрж╛рждрзЗ timer *ржкрзНрж░рждрж┐* рж╕рзЗржХрзЗржирзНржбрзЗ ржмрж┐рж░рждрж┐ ржЫрж╛ржбрж╝рж╛ржЗ tick ржХрж░рзЗред

<Hint>

ржоржирзЗ рж╣ржЪрзНржЫрзЗ ржпрзЗ Effect ржпрж╛ timer рж╕рзЗржЯ ржЖржк ржХрж░рзЗ рждрж╛ `increment` value ржПрж░ ржкрзНрж░рждрж┐ "react" ржХрж░рзЗред ржмрж░рзНрждржорж╛ржи `increment` value ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ `setCount` ржХрж▓ ржХрж░рж╛рж░ рж▓рж╛ржЗржиржЯрж┐ ржХрж┐ рж╕рждрзНржпрж┐ржЗ reactive рж╣ржУржпрж╝рж╛ ржкрзНрж░ржпрж╝рзЛржЬржи?

</Hint>

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);

  useEffect(() => {
    const id = setInterval(() => {
      setCount(c => c + increment);
    }, 1000);
    return () => {
      clearInterval(id);
    };
  }, [increment]);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Every second, increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
    </>
  );
}
```

```css
button { margin: 10px; }
```

</Sandpack>

<Solution>

рж╕ржорж╕рзНржпрж╛ рж╣рж▓ ржпрзЗ Effect ржПрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб `increment` state variable ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред ржпрзЗрж╣рзЗрждрзБ ржПржЯрж┐ ржЖржкржирж╛рж░ Effect ржПрж░ ржПржХржЯрж┐ dependency, `increment` ржПрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи Effect ржХрзЗ ржкрзБржирж░рж╛ржпрж╝ рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛ржЗржЬ ржХрж░рзЗ, ржпрж╛ interval clear ржХрж░рзЗред ржпржжрж┐ ржЖржкржирж┐ ржкрзНрж░рждрж┐ржмрж╛рж░ fire рж╣ржУржпрж╝рж╛рж░ рж╕рзБржпрзЛржЧ ржкрж╛ржУржпрж╝рж╛рж░ ржЖржЧрзЗ interval clear ржХрж░рждрзЗ ржерж╛ржХрзЗржи, рждрж╛рж╣рж▓рзЗ ржоржирзЗ рж╣ржмрзЗ ржпрзЗржи timer stall рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗред

рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржХрж░рждрзЗ, Effect ржерзЗржХрзЗ ржПржХржЯрж┐ `onTick` Effect Event extract ржХрж░рзБржи:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);

  const onTick = useEffectEvent(() => {
    setCount(c => c + increment);
  });

  useEffect(() => {
    const id = setInterval(() => {
      onTick();
    }, 1000);
    return () => {
      clearInterval(id);
    };
  }, []);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Every second, increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
    </>
  );
}
```


```css
button { margin: 10px; }
```

</Sandpack>

ржпрзЗрж╣рзЗрждрзБ `onTick` ржПржХржЯрж┐ Effect Event, ржПрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб reactive ржиржпрж╝ред `increment` ржПрж░ ржкрж░рж┐ржмрж░рзНрждржи ржХрзЛржирзЛ Effect trigger ржХрж░рзЗ ржирж╛ред

</Solution>

#### ржПржХржЯрж┐ non-adjustable delay ржарж┐ржХ ржХрж░рзБржи {/*fix-a-non-adjustable-delay*/}

ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ, ржЖржкржирж┐ interval delay customize ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржПржЯрж┐ ржПржХржЯрж┐ `delay` state variable ржП рж╕ржВрж░ржХрзНрж╖рж┐ржд ржпрж╛ ржжрзБржЯрж┐ button ржжрзНржмрж╛рж░рж╛ update ржХрж░рж╛ рж╣ржпрж╝ред рждржмрзЗ, ржПржоржиржХрж┐ ржЖржкржирж┐ "plus 100 ms" button ржЪрж╛ржкрждрзЗ ржерж╛ржХрж▓рзЗржУ ржпрждржХрзНрж╖ржг ржирж╛ `delay` 1000 milliseconds (ржЕрж░рзНржерж╛рзО, ржПржХ рж╕рзЗржХрзЗржирзНржб) рж╣ржпрж╝, ржЖржкржирж┐ рж▓ржХрзНрж╖рзНржп ржХрж░ржмрзЗржи ржпрзЗ timer ржПржЦржиржУ ржЦрзБржм ржжрзНрж░рзБржд (ржкрзНрж░рждрж┐ 100 ms) ржмрзГржжрзНржзрж┐ ржкрж╛ржЪрзНржЫрзЗред ржоржирзЗ рж╣ржЪрзНржЫрзЗ ржЖржкржирж╛рж░ `delay` ржПрж░ ржкрж░рж┐ржмрж░рзНрждржиржЧрзБрж▓рж┐ ржЙржкрзЗржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗред bug ржЦрзБржБржЬрзБржи ржПржмржВ ржарж┐ржХ ржХрж░рзБржиред

<Hint>

Effect Event ржПрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб reactive ржиржпрж╝ред ржПржоржи ржХрж┐ ржХрзЛржирзЛ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржЫрзЗ ржпрзЗржЦрж╛ржирзЗ ржЖржкржирж┐ `setInterval` call ржкрзБржирж░рж╛ржпрж╝ ржЪрж╛рж▓рзБ _ржЪрж╛ржЗржмрзЗржи_?

</Hint>

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);
  const [delay, setDelay] = useState(100);

  const onTick = useEffectEvent(() => {
    setCount(c => c + increment);
  });

  const onMount = useEffectEvent(() => {
    return setInterval(() => {
      onTick();
    }, delay);
  });

  useEffect(() => {
    const id = onMount();
    return () => {
      clearInterval(id);
    }
  }, []);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
      <p>
        Increment delay:
        <button disabled={delay === 100} onClick={() => {
          setDelay(d => d - 100);
        }}>тАУ100 ms</button>
        <b>{delay} ms</b>
        <button onClick={() => {
          setDelay(d => d + 100);
        }}>+100 ms</button>
      </p>
    </>
  );
}
```


```css
button { margin: 10px; }
```

</Sandpack>

<Solution>

ржЙржкрж░рзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗрж░ рж╕ржорж╕рзНржпрж╛ рж╣рж▓ ржпрзЗ ржПржЯрж┐ `onMount` ржирж╛ржорзЗ ржПржХржЯрж┐ Effect Event extract ржХрж░рзЗржЫрзЗ ржХрзЛржбржЯрж┐ ржЖрж╕рж▓рзЗ ржХрж┐ ржХрж░рж╛ ржЙржЪрж┐ржд рждрж╛ ржмрж┐ржмрзЗржЪржирж╛ ржирж╛ ржХрж░рзЗред ржЖржкржирж╛рж░ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж╛рж░ржгрзЗ Effect Event extract ржХрж░рж╛ ржЙржЪрж┐ржд: ржпржЦржи ржЖржкржирж┐ ржЖржкржирж╛рж░ ржХрзЛржбрзЗрж░ ржПржХржЯрж┐ ржЕржВрж╢ non-reactive ржХрж░рждрзЗ ржЪрж╛ржиред рждржмрзЗ, `setInterval` call `delay` state variable ржПрж░ рж╕рж╛ржкрзЗржХрзНрж╖рзЗ reactive *рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд*ред ржпржжрж┐ `delay` ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржЖржкржирж┐ interval ржирждрзБржи ржХрж░рзЗ рж╕рзЗржЯ ржЖржк ржХрж░рждрзЗ ржЪрж╛ржи! ржПржЗ ржХрзЛржб ржарж┐ржХ ржХрж░рждрзЗ, рж╕ржорж╕рзНржд reactive ржХрзЛржб Effect ржПрж░ ржнрж┐рждрж░рзЗ ржлрж┐рж░рж┐ржпрж╝рзЗ ржЖржирзБржи:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export default function Timer() {
  const [count, setCount] = useState(0);
  const [increment, setIncrement] = useState(1);
  const [delay, setDelay] = useState(100);

  const onTick = useEffectEvent(() => {
    setCount(c => c + increment);
  });

  useEffect(() => {
    const id = setInterval(() => {
      onTick();
    }, delay);
    return () => {
      clearInterval(id);
    }
  }, [delay]);

  return (
    <>
      <h1>
        Counter: {count}
        <button onClick={() => setCount(0)}>Reset</button>
      </h1>
      <hr />
      <p>
        Increment by:
        <button disabled={increment === 0} onClick={() => {
          setIncrement(i => i - 1);
        }}>тАУ</button>
        <b>{increment}</b>
        <button onClick={() => {
          setIncrement(i => i + 1);
        }}>+</button>
      </p>
      <p>
        Increment delay:
        <button disabled={delay === 100} onClick={() => {
          setDelay(d => d - 100);
        }}>тАУ100 ms</button>
        <b>{delay} ms</b>
        <button onClick={() => {
          setDelay(d => d + 100);
        }}>+100 ms</button>
      </p>
    </>
  );
}
```

```css
button { margin: 10px; }
```

</Sandpack>

рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржЖржкржирж╛рж░ `onMount` ржПрж░ ржорждрзЛ function рж╕ржорзНржкрж░рзНржХрзЗ рж╕ржирзНржжрзЗрж╣ржЬржиржХ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд ржпрж╛ ржХрзЛржбрзЗрж░ ржПржХржЯрж┐ ржЕржВрж╢рзЗрж░ *ржЙржжрзНржжрзЗрж╢рзНржп* ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ *timing* ржПрж░ ржЙржкрж░ ржлрзЛржХрж╛рж╕ ржХрж░рзЗред ржПржЯрж┐ ржкрзНрж░ржержорзЗ "ржЖрж░ржУ ржмрж░рзНржгржирж╛ржорзВрж▓ржХ" ржоржирзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ ржХрж┐ржирзНрждрзБ ржПржЯрж┐ ржЖржкржирж╛рж░ intent ржЕрж╕рзНржкрж╖рзНржЯ ржХрж░рзЗред ржПржХржЯрж┐ ржирж┐ржпрж╝ржо рж╣рж┐рж╕рж╛ржмрзЗ, Effect Event *ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░* ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ ржпрж╛ ржШржЯрзЗ рждрж╛рж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, `onMessage`, `onTick`, `onVisit`, ржмрж╛ `onConnected` ржнрж╛рж▓рзЛ Effect Event ржирж╛ржоред рждрж╛ржжрзЗрж░ ржнрж┐рждрж░рзЗрж░ ржХрзЛржб рж╕ржорзНржнржмржд reactive рж╣ржУржпрж╝рж╛рж░ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржмрзЗ ржирж╛ред ржЕржирзНржпржжрж┐ржХрзЗ, `onMount`, `onUpdate`, `onUnmount`, ржмрж╛ `onAfterRender` ржПржд generic ржпрзЗ ржнрзБрж▓ржмрж╢ржд ржПржоржи ржХрзЛржб рж░рж╛ржЦрж╛ рж╕рж╣ржЬ ржпрж╛ reactive *рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд*ред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржЖржкржирж╛рж░ Effect Event ржПрж░ ржирж╛ржо *ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржХрж┐ ржоржирзЗ ржХрж░рзЗ ржШржЯрзЗржЫрзЗ* рждрж╛рж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рж░рж╛ржЦрж╛ ржЙржЪрж┐ржд, ржХрж┐ржЫрзБ ржХрзЛржб ржХржЦржи ржЪрж╛рж▓рзБ рж╣ржпрж╝рзЗржЫрж┐рж▓ рждрж╛рж░ ржЙржкрж░ ржиржпрж╝ред

</Solution>

#### ржПржХржЯрж┐ delayed notification ржарж┐ржХ ржХрж░рзБржи {/*fix-a-delayed-notification*/}

ржпржЦржи ржЖржкржирж┐ ржПржХржЯрж┐ chat room ржП ржпрзЛржЧ ржжрзЗржи, ржПржЗ ржХржорзНржкрзЛржирзЗржирзНржЯ ржПржХржЯрж┐ notification ржжрзЗржЦрж╛ржпрж╝ред рждржмрзЗ, ржПржЯрж┐ notification ржЕржмрж┐рж▓ржорзНржмрзЗ ржжрзЗржЦрж╛ржпрж╝ ржирж╛ред ржкрж░рж┐ржмрж░рзНрждрзЗ, notification ржХрзГрждрзНрж░рж┐ржоржнрж╛ржмрзЗ ржжрзБржЗ рж╕рзЗржХрзЗржирзНржб delay ржХрж░рж╛ рж╣ржпрж╝ ржпрж╛рждрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА UI ржПрж░ ржЪрж╛рж░ржкрж╛рж╢рзЗ рждрж╛ржХрж╛ржирзЛрж░ рж╕рзБржпрзЛржЧ ржкрж╛ржпрж╝ред

ржПржЯрж┐ ржкрзНрж░рж╛ржпрж╝ ржХрж╛ржЬ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ ржПржХржЯрж┐ bug ржЖржЫрзЗред dropdown "general" ржерзЗржХрзЗ "travel" ржПржмржВ рждрж╛рж░ржкрж░ "music" ржП ржЦрзБржм ржжрзНрж░рзБржд ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред ржпржжрж┐ ржЖржкржирж┐ ржПржЯрж┐ ржпржерзЗрж╖рзНржЯ ржжрзНрж░рзБржд ржХрж░рзЗржи, ржЖржкржирж┐ ржжрзБржЯрж┐ notification ржжрзЗржЦржмрзЗржи (ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд!) ржХрж┐ржирзНрждрзБ рждрж╛рж░рж╛ *ржЙржнржпрж╝ржЗ* ржмрж▓ржмрзЗ "Welcome to music"ред

ржПржЯрж┐ ржарж┐ржХ ржХрж░рзБржи ржпрж╛рждрзЗ ржЖржкржирж┐ ржпржЦржи "general" ржерзЗржХрзЗ "travel" ржПржмржВ рждрж╛рж░ржкрж░ "music" ржП ржЦрзБржм ржжрзНрж░рзБржд switch ржХрж░рзЗржи, ржЖржкржирж┐ ржжрзБржЯрж┐ notification ржжрзЗржЦрзЗржи, ржкрзНрж░ржержоржЯрж┐ "Welcome to travel" ржПржмржВ ржжрзНржмрж┐рждрзАржпрж╝ржЯрж┐ "Welcome to music"ред (ржПржХржЯрж┐ ржЕрждрж┐рж░рж┐ржХрзНржд challenge ржПрж░ ржЬржирзНржп, ржзрж░рзЗ ржирж┐ржЪрзНржЫрж┐ ржЖржкржирж┐ *ржЗрждрж┐ржоржзрзНржпрзЗ* notification ржЧрзБрж▓рж┐ рж╕ржарж┐ржХ room ржжрзЗржЦрж╛рждрзЗ рждрзИрж░рж┐ ржХрж░рзЗржЫрзЗржи, ржХрзЛржб ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзБржи ржпрж╛рждрзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржкрж░ржмрж░рзНрждрзА notification ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржпрж╝ред)

<Hint>

ржЖржкржирж╛рж░ Effect ржЬрж╛ржирзЗ ржПржЯрж┐ ржХрзЛржи room ржП рж╕ржВржпрзБржХрзНржд рж╣ржпрж╝рзЗржЫрж┐рж▓ред ржПржоржи ржХрзЛржирзЛ рждржерзНржп ржЖржЫрзЗ ржпрж╛ ржЖржкржирж┐ ржЖржкржирж╛рж░ Effect Event ржП pass ржХрж░рждрзЗ ржЪрж╛ржЗрждрзЗ ржкрж╛рж░рзЗржи?

</Hint>

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest",
    "toastify-js": "1.12.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';
import { createConnection, sendMessage } from './chat.js';
import { showNotification } from './notifications.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(() => {
    showNotification('Welcome to ' + roomId, theme);
  });

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      setTimeout(() => {
        onConnected();
      }, 2000);
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]);

  return <h1>Welcome to the {roomId} room!</h1>
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [isDark, setIsDark] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <label>
        <input
          type="checkbox"
          checked={isDark}
          onChange={e => setIsDark(e.target.checked)}
        />
        Use dark theme
      </label>
      <hr />
      <ChatRoom
        roomId={roomId}
        theme={isDark ? 'dark' : 'light'}
      />
    </>
  );
}
```

```js src/chat.js
export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  let connectedCallback;
  let timeout;
  return {
    connect() {
      timeout = setTimeout(() => {
        if (connectedCallback) {
          connectedCallback();
        }
      }, 100);
    },
    on(event, callback) {
      if (connectedCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'connected') {
        throw Error('Only "connected" event is supported.');
      }
      connectedCallback = callback;
    },
    disconnect() {
      clearTimeout(timeout);
    }
  };
}
```

```js src/notifications.js hidden
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme) {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

```css
label { display: block; margin-top: 10px; }
```

</Sandpack>

<Solution>

ржЖржкржирж╛рж░ Effect Event ржПрж░ ржнрж┐рждрж░рзЗ, `roomId` рж╣рж▓ рж╕рзЗржЗ ржорж╛ржи *ржпржЦржи Effect Event ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрж┐рж▓ред*

ржЖржкржирж╛рж░ Effect Event ржжрзБржЗ рж╕рзЗржХрзЗржирзНржб delay рж╕рж╣ ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝ред ржпржжрж┐ ржЖржкржирж┐ ржжрзНрж░рзБржд travel ржерзЗржХрзЗ music room ржП switch ржХрж░ржЫрзЗржи, ржпржЦржи travel room ржПрж░ notification ржжрзЗржЦрж╛ржпрж╝, `roomId` ржЗрждрж┐ржоржзрзНржпрзЗ `"music"`ред ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржЙржнржпрж╝ notification "Welcome to music" ржмрж▓рзЗред

рж╕ржорж╕рзНржпрж╛ ржарж┐ржХ ржХрж░рждрзЗ, Effect Event ржПрж░ ржнрж┐рждрж░рзЗ *рж╕рж░рзНржмрж╢рзЗрж╖* `roomId` ржкржбрж╝рж╛рж░ ржкрж░рж┐ржмрж░рзНрждрзЗ, ржПржЯрж┐ржХрзЗ ржЖржкржирж╛рж░ Effect Event ржПрж░ ржПржХржЯрж┐ parameter ржХрж░рзБржи, ржпрзЗржоржи ржирж┐ржЪрзЗ `connectedRoomId`ред рждрж╛рж░ржкрж░ `onConnected(roomId)` ржХрж▓ ржХрж░рзЗ ржЖржкржирж╛рж░ Effect ржерзЗржХрзЗ `roomId` pass ржХрж░рзБржи:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest",
    "toastify-js": "1.12.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';
import { createConnection, sendMessage } from './chat.js';
import { showNotification } from './notifications.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(connectedRoomId => {
    showNotification('Welcome to ' + connectedRoomId, theme);
  });

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    connection.on('connected', () => {
      setTimeout(() => {
        onConnected(roomId);
      }, 2000);
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]);

  return <h1>Welcome to the {roomId} room!</h1>
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [isDark, setIsDark] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <label>
        <input
          type="checkbox"
          checked={isDark}
          onChange={e => setIsDark(e.target.checked)}
        />
        Use dark theme
      </label>
      <hr />
      <ChatRoom
        roomId={roomId}
        theme={isDark ? 'dark' : 'light'}
      />
    </>
  );
}
```

```js src/chat.js
export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  let connectedCallback;
  let timeout;
  return {
    connect() {
      timeout = setTimeout(() => {
        if (connectedCallback) {
          connectedCallback();
        }
      }, 100);
    },
    on(event, callback) {
      if (connectedCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'connected') {
        throw Error('Only "connected" event is supported.');
      }
      connectedCallback = callback;
    },
    disconnect() {
      clearTimeout(timeout);
    }
  };
}
```

```js src/notifications.js hidden
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme) {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

```css
label { display: block; margin-top: 10px; }
```

</Sandpack>

ржпрзЗ Effect ржП `roomId` `"travel"` ржП set ржЫрж┐рж▓ (рждрж╛ржЗ ржПржЯрж┐ `"travel"` room ржП рж╕ржВржпрзБржХрзНржд рж╣ржпрж╝рзЗржЫрж┐рж▓) рж╕рзЗржЯрж┐ `"travel"` ржПрж░ ржЬржирзНржп notification ржжрзЗржЦрж╛ржмрзЗред ржпрзЗ Effect ржП `roomId` `"music"` ржП set ржЫрж┐рж▓ (рждрж╛ржЗ ржПржЯрж┐ `"music"` room ржП рж╕ржВржпрзБржХрзНржд рж╣ржпрж╝рзЗржЫрж┐рж▓) рж╕рзЗржЯрж┐ `"music"` ржПрж░ ржЬржирзНржп notification ржжрзЗржЦрж╛ржмрзЗред ржЕржирзНржп ржХржерж╛ржпрж╝, `connectedRoomId` ржЖржкржирж╛рж░ Effect ржерзЗржХрзЗ ржЖрж╕рзЗ (ржпрж╛ reactive), ржпрзЗржЦрж╛ржирзЗ `theme` рж╕рж░рзНржмржжрж╛ рж╕рж░рзНржмрж╢рзЗрж╖ ржорж╛ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

ржЕрждрж┐рж░рж┐ржХрзНржд challenge рж╕ржорж╛ржзрж╛ржи ржХрж░рждрзЗ, notification timeout ID рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи ржПржмржВ ржЖржкржирж╛рж░ Effect ржПрж░ cleanup function ржП ржПржЯрж┐ clear ржХрж░рзБржи:

<Sandpack>

```json package.json hidden
{
  "dependencies": {
    "react": "experimental",
    "react-dom": "experimental",
    "react-scripts": "latest",
    "toastify-js": "1.12.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test --env=jsdom",
    "eject": "react-scripts eject"
  }
}
```

```js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';
import { createConnection, sendMessage } from './chat.js';
import { showNotification } from './notifications.js';

const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId, theme }) {
  const onConnected = useEffectEvent(connectedRoomId => {
    showNotification('Welcome to ' + connectedRoomId, theme);
  });

  useEffect(() => {
    const connection = createConnection(serverUrl, roomId);
    let notificationTimeoutId;
    connection.on('connected', () => {
      notificationTimeoutId = setTimeout(() => {
        onConnected(roomId);
      }, 2000);
    });
    connection.connect();
    return () => {
      connection.disconnect();
      if (notificationTimeoutId !== undefined) {
        clearTimeout(notificationTimeoutId);
      }
    };
  }, [roomId]);

  return <h1>Welcome to the {roomId} room!</h1>
}

export default function App() {
  const [roomId, setRoomId] = useState('general');
  const [isDark, setIsDark] = useState(false);
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select
          value={roomId}
          onChange={e => setRoomId(e.target.value)}
        >
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <label>
        <input
          type="checkbox"
          checked={isDark}
          onChange={e => setIsDark(e.target.checked)}
        />
        Use dark theme
      </label>
      <hr />
      <ChatRoom
        roomId={roomId}
        theme={isDark ? 'dark' : 'light'}
      />
    </>
  );
}
```

```js src/chat.js
export function createConnection(serverUrl, roomId) {
  // A real implementation would actually connect to the server
  let connectedCallback;
  let timeout;
  return {
    connect() {
      timeout = setTimeout(() => {
        if (connectedCallback) {
          connectedCallback();
        }
      }, 100);
    },
    on(event, callback) {
      if (connectedCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'connected') {
        throw Error('Only "connected" event is supported.');
      }
      connectedCallback = callback;
    },
    disconnect() {
      clearTimeout(timeout);
    }
  };
}
```

```js src/notifications.js hidden
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme) {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

```css
label { display: block; margin-top: 10px; }
```

</Sandpack>

ржПржЯрж┐ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ ржпрзЗ ржЗрждрж┐ржоржзрзНржпрзЗ scheduled (ржХрж┐ржирзНрждрзБ ржПржЦржиржУ ржкрзНрж░ржжрж░рзНрж╢рж┐ржд рж╣ржпрж╝ржирж┐) notification ржЧрзБрж▓рж┐ ржЖржкржирж┐ room ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж▓рзЗ cancel рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ред

</Solution>

</Challenges>
